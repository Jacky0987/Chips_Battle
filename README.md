# Chips Battle Remake v3.0 Alpha

ä¸€ä¸ªç°ä»£åŒ–çš„å‘½ä»¤è¡Œæ¸¸æˆï¼ŒåŸºäºç»å…¸çš„ Chips Battle é‡åˆ¶è€Œæˆã€‚é‡‡ç”¨ Python å¼‚æ­¥æ¶æ„ï¼Œæä¾›ä¸°å¯Œçš„æ¸¸æˆä½“éªŒå’Œæ‰©å±•æ€§ã€‚

## ğŸ® æ¸¸æˆç‰¹è‰²

- **å‘½ä»¤é©±åŠ¨**: é€šè¿‡è¾“å…¥å‘½ä»¤ä¸æ¸¸æˆä¸–ç•Œäº’åŠ¨
- **å¤šè´§å¸ç³»ç»Ÿ**: æ”¯æŒ JCCã€CNYã€USDã€EUR ç­‰å¤šç§è´§å¸
- **è‚¡ç¥¨å¸‚åœº**: æ¨¡æ‹ŸçœŸå®çš„è‚¡ç¥¨äº¤æ˜“ç³»ç»Ÿ
- **åº”ç”¨å¸‚åœº**: åˆ›å»ºå’Œå‘å¸ƒè‡ªå·±çš„åº”ç”¨ç¨‹åº
- **æ–°é—»ç³»ç»Ÿ**: å®æ—¶çš„æ¸¸æˆä¸–ç•Œæ–°é—»å’Œäº‹ä»¶
- **ç”¨æˆ·ç³»ç»Ÿ**: å®Œæ•´çš„ç”¨æˆ·æ³¨å†Œã€è®¤è¯å’Œæƒé™ç®¡ç†
- **äº‹ä»¶é©±åŠ¨**: åŸºäºäº‹ä»¶æ€»çº¿çš„æ¾è€¦åˆæ¶æ„

## ğŸ—ï¸ æŠ€æœ¯æ¶æ„

### æ ¸å¿ƒæŠ€æœ¯æ ˆ
- **Python 3.8+**: ä¸»è¦å¼€å‘è¯­è¨€
- **SQLAlchemy**: ORM å’Œæ•°æ®åº“æŠ½è±¡å±‚
- **Rich**: ç»ˆç«¯ UI å’Œæ–‡æœ¬æ¸²æŸ“
- **Pydantic**: æ•°æ®éªŒè¯å’Œè®¾ç½®ç®¡ç†
- **Asyncio**: å¼‚æ­¥ç¼–ç¨‹æ”¯æŒ

### æ¶æ„è®¾è®¡
```
â”œâ”€â”€ config/          # é…ç½®ç®¡ç†
â”œâ”€â”€ core/            # æ ¸å¿ƒç³»ç»Ÿï¼ˆäº‹ä»¶æ€»çº¿ç­‰ï¼‰
â”œâ”€â”€ dal/             # æ•°æ®è®¿é—®å±‚
â”œâ”€â”€ models/          # æ•°æ®æ¨¡å‹
â”œâ”€â”€ services/        # ä¸šåŠ¡é€»è¾‘æœåŠ¡
â”œâ”€â”€ commands/        # å‘½ä»¤ç³»ç»Ÿ
â”œâ”€â”€ migrations/      # æ•°æ®åº“è¿ç§»
â””â”€â”€ main.py          # åº”ç”¨å…¥å£
```

## ğŸš€ å¿«é€Ÿå¼€å§‹

### ç¯å¢ƒè¦æ±‚
- Python 3.8 æˆ–æ›´é«˜ç‰ˆæœ¬
- pip åŒ…ç®¡ç†å™¨

### å®‰è£…æ­¥éª¤

1. **å…‹éš†é¡¹ç›®**
   ```bash
   git clone <repository-url>
   cd Chips_Battle
   ```

2. **å®‰è£…ä¾èµ–**
   ```bash
   pip install -r requirements.txt
   ```

3. **åˆå§‹åŒ–æ•°æ®åº“**
   ```bash
   python migrations/init_db.py
   ```

4. **å¯åŠ¨æ¸¸æˆ**
   ```bash
   python main.py
   ```

### é¦–æ¬¡ç™»å½•

æ•°æ®åº“åˆå§‹åŒ–åä¼šè‡ªåŠ¨åˆ›å»ºç®¡ç†å‘˜è´¦æˆ·ï¼š
- **ç”¨æˆ·å**: `admin`
- **å¯†ç **: `admin123`

âš ï¸ **é‡è¦**: è¯·åœ¨é¦–æ¬¡ç™»å½•åç«‹å³æ›´æ”¹å¯†ç ï¼

## ğŸ¯ æ¸¸æˆæŒ‡å—

### åŸºç¡€å‘½ä»¤

| å‘½ä»¤ | è¯´æ˜ | ç¤ºä¾‹ |
|------|------|------|
| `help` | æ˜¾ç¤ºå¸®åŠ©ä¿¡æ¯ | `help`, `help wallet` |
| `status` | æŸ¥çœ‹å½“å‰çŠ¶æ€ | `status` |
| `profile` | ç®¡ç†ä¸ªäººèµ„æ–™ | `profile`, `profile edit` |
| `quit` | é€€å‡ºæ¸¸æˆ | `quit`, `quit --force` |

### è´¢åŠ¡å‘½ä»¤

| å‘½ä»¤ | è¯´æ˜ | ç¤ºä¾‹ |
|------|------|------|
| `wallet` | æŸ¥çœ‹é’±åŒ…ä½™é¢ | `wallet`, `wallet CNY` |
| `transfer` | è½¬è´¦ç»™å…¶ä»–ç”¨æˆ· | `transfer user123 1000 CNY` |
| `exchange` | è´§å¸å…‘æ¢ | `exchange CNY USD 1000` |

### è‚¡ç¥¨å‘½ä»¤

| å‘½ä»¤ | è¯´æ˜ | ç¤ºä¾‹ |
|------|------|------|
| `market` | æŸ¥çœ‹è‚¡ç¥¨å¸‚åœº | `market`, `market AAPL` |
| `buy` | è´­ä¹°è‚¡ç¥¨ | `buy AAPL 100` |
| `sell` | å‡ºå”®è‚¡ç¥¨ | `sell AAPL 50` |
| `portfolio` | æŸ¥çœ‹æŠ•èµ„ç»„åˆ | `portfolio` |

### åº”ç”¨å‘½ä»¤

| å‘½ä»¤ | è¯´æ˜ | ç¤ºä¾‹ |
|------|------|------|
| `apps` | æµè§ˆåº”ç”¨å¸‚åœº | `apps`, `apps search game` |
| `install` | å®‰è£…åº”ç”¨ | `install app123` |
| `create` | åˆ›å»ºæ–°åº”ç”¨ | `create "My App"` |

## ğŸ”§ å¼€å‘æŒ‡å—

### é¡¹ç›®ç»“æ„è¯¦è§£

#### é…ç½®ç³»ç»Ÿ (`config/`)
- `settings.py`: å…¨å±€é…ç½®ç®¡ç†ï¼Œæ”¯æŒç¯å¢ƒå˜é‡å’Œæ–‡ä»¶é…ç½®

#### æ ¸å¿ƒç³»ç»Ÿ (`core/`)
- `event_bus.py`: äº‹ä»¶æ€»çº¿ï¼Œæ”¯æŒå‘å¸ƒ-è®¢é˜…æ¨¡å¼

#### æ•°æ®è®¿é—®å±‚ (`dal/`)
- `database.py`: æ•°æ®åº“å¼•æ“å’Œè¿æ¥ç®¡ç†
- `unit_of_work.py`: å·¥ä½œå•å…ƒæ¨¡å¼å®ç°

#### æ•°æ®æ¨¡å‹ (`models/`)
- `base.py`: åŸºç¡€æ¨¡å‹ç±»å’Œæ··å…¥
- `auth/`: è®¤è¯ç›¸å…³æ¨¡å‹ï¼ˆç”¨æˆ·ã€è§’è‰²ã€æƒé™ï¼‰

#### æœåŠ¡å±‚ (`services/`)
- `auth_service.py`: è®¤è¯å’ŒæˆæƒæœåŠ¡
- `command_dispatcher.py`: å‘½ä»¤åˆ†å‘å™¨
- `time_service.py`: æ¸¸æˆæ—¶é—´ç®¡ç†

#### å‘½ä»¤ç³»ç»Ÿ (`commands/`)
- `base.py`: å‘½ä»¤åŸºç±»å’Œè§£æå™¨
- `registry.py`: å‘½ä»¤æ³¨å†Œå™¨
- `basic/`: åŸºç¡€å‘½ä»¤å®ç°

### æ·»åŠ æ–°å‘½ä»¤

1. **åˆ›å»ºå‘½ä»¤ç±»**
   ```python
   from commands.base import BasicCommand, CommandResult, CommandContext
   
   class MyCommand(BasicCommand):
       def __init__(self):
           super().__init__()
           self.name = "mycommand"
           self.description = "æˆ‘çš„è‡ªå®šä¹‰å‘½ä»¤"
       
       async def execute(self, args, context):
           return self.success("å‘½ä»¤æ‰§è¡ŒæˆåŠŸï¼")
   ```

2. **æ³¨å†Œå‘½ä»¤**
   ```python
   # åœ¨é€‚å½“çš„æ¨¡å—ä¸­æ³¨å†Œå‘½ä»¤
   from commands.registry import CommandRegistry
   
   registry = CommandRegistry()
   registry.register(MyCommand())
   ```

### æ·»åŠ æ–°æœåŠ¡

1. **åˆ›å»ºæœåŠ¡ç±»**
   ```python
   class MyService:
       def __init__(self, uow, event_bus):
           self.uow = uow
           self.event_bus = event_bus
       
       async def do_something(self):
           # ä¸šåŠ¡é€»è¾‘
           pass
   ```

2. **åœ¨ä¸»åº”ç”¨ä¸­æ³¨å†Œ**
   ```python
   # åœ¨ main.py ä¸­æ·»åŠ æœåŠ¡åˆå§‹åŒ–
   self.my_service = MyService(self.uow, self.event_bus)
   ```

## ğŸ—„ï¸ æ•°æ®åº“ç®¡ç†

### åˆå§‹åŒ–æ•°æ®åº“
```bash
python migrations/init_db.py
```

### é‡ç½®æ•°æ®åº“
```bash
python migrations/init_db.py --reset
```

### æ•°æ®åº“é…ç½®

é»˜è®¤ä½¿ç”¨ SQLite æ•°æ®åº“ï¼Œé…ç½®æ–‡ä»¶ä½äº `config/settings.py`ï¼š

```python
class DatabaseConfig:
    driver: str = "sqlite+aiosqlite"
    name: str = "chips_battle.db"
    # å…¶ä»–é…ç½®...
```

## ğŸ” æƒé™ç³»ç»Ÿ

### è§’è‰²å±‚çº§
1. **admin**: ç³»ç»Ÿç®¡ç†å‘˜ï¼Œæ‹¥æœ‰æ‰€æœ‰æƒé™
2. **moderator**: ç‰ˆä¸»ï¼Œæ‹¥æœ‰å†…å®¹ç®¡ç†æƒé™
3. **user**: æ™®é€šç”¨æˆ·ï¼ŒåŸºç¡€åŠŸèƒ½æƒé™
4. **guest**: è®¿å®¢ï¼Œåªè¯»æƒé™

### æƒé™ç±»å‹
- **system.***: ç³»ç»Ÿç®¡ç†æƒé™
- **content.***: å†…å®¹ç®¡ç†æƒé™
- **finance.***: è´¢åŠ¡æ“ä½œæƒé™
- **user.***: ç”¨æˆ·æ“ä½œæƒé™

## ğŸ¨ è‡ªå®šä¹‰é…ç½®

### ç¯å¢ƒå˜é‡
```bash
# æ•°æ®åº“é…ç½®
DB_NAME=my_game.db
DB_ECHO=true

# æ¸¸æˆé…ç½®
GAME_INITIAL_MONEY=10000
GAME_MAX_LEVEL=100

# å®‰å…¨é…ç½®
SECURITY_PASSWORD_MIN_LENGTH=8
SECURITY_SESSION_TIMEOUT=3600
```

### é…ç½®æ–‡ä»¶
åˆ›å»º `.env` æ–‡ä»¶æ¥è¦†ç›–é»˜è®¤é…ç½®ï¼š
```env
DB_NAME=production.db
GAME_INITIAL_MONEY=5000
LOG_LEVEL=INFO
```

## ğŸ§ª æµ‹è¯•

```bash
# è¿è¡Œæ‰€æœ‰æµ‹è¯•
python -m pytest

# è¿è¡Œç‰¹å®šæµ‹è¯•
python -m pytest tests/test_auth.py

# ç”Ÿæˆè¦†ç›–ç‡æŠ¥å‘Š
python -m pytest --cov=. --cov-report=html
```

## ğŸ“ æ—¥å¿—

æ—¥å¿—æ–‡ä»¶ä½äº `logs/` ç›®å½•ï¼š
- `app.log`: åº”ç”¨æ—¥å¿—
- `error.log`: é”™è¯¯æ—¥å¿—
- `debug.log`: è°ƒè¯•æ—¥å¿—ï¼ˆå¼€å‘æ¨¡å¼ï¼‰

## ğŸ¤ è´¡çŒ®æŒ‡å—

1. Fork é¡¹ç›®
2. åˆ›å»ºç‰¹æ€§åˆ†æ”¯ (`git checkout -b feature/AmazingFeature`)
3. æäº¤æ›´æ”¹ (`git commit -m 'Add some AmazingFeature'`)
4. æ¨é€åˆ°åˆ†æ”¯ (`git push origin feature/AmazingFeature`)
5. å¼€å¯ Pull Request

### ä»£ç è§„èŒƒ
- ä½¿ç”¨ Black è¿›è¡Œä»£ç æ ¼å¼åŒ–
- éµå¾ª PEP 8 ç¼–ç è§„èŒƒ
- æ·»åŠ é€‚å½“çš„ç±»å‹æ³¨è§£
- ç¼–å†™å•å…ƒæµ‹è¯•

## ğŸ“„ è®¸å¯è¯

æœ¬é¡¹ç›®é‡‡ç”¨ MIT è®¸å¯è¯ - æŸ¥çœ‹ [LICENSE](LICENSE) æ–‡ä»¶äº†è§£è¯¦æƒ…ã€‚

## ğŸ†˜ æ”¯æŒ

å¦‚æœä½ é‡åˆ°é—®é¢˜æˆ–æœ‰å»ºè®®ï¼Œè¯·ï¼š

1. æŸ¥çœ‹ [FAQ](docs/FAQ.md)
2. æœç´¢ç°æœ‰çš„ [Issues](../../issues)
3. åˆ›å»ºæ–°çš„ Issue
4. åŠ å…¥æˆ‘ä»¬çš„è®¨è®ºç¾¤

## ğŸ—ºï¸ è·¯çº¿å›¾

### v3.0 Alpha (å½“å‰ç‰ˆæœ¬)
- [x] åŸºç¡€æ¶æ„æ­å»º
- [x] ç”¨æˆ·è®¤è¯ç³»ç»Ÿ
- [x] å‘½ä»¤ç³»ç»Ÿæ¡†æ¶
- [x] æ•°æ®åº“è®¾è®¡
- [ ] åŸºç¡€å‘½ä»¤å®ç°
- [ ] è´¢åŠ¡ç³»ç»Ÿ

### v3.0 Beta
- [ ] è‚¡ç¥¨å¸‚åœºç³»ç»Ÿ
- [ ] åº”ç”¨å¸‚åœº
- [ ] æ–°é—»ç³»ç»Ÿ
- [ ] Web ç•Œé¢

### v3.0 æ­£å¼ç‰ˆ
- [ ] å¤šäººåœ¨çº¿åŠŸèƒ½
- [ ] å®æ—¶é€šä¿¡
- [ ] ç§»åŠ¨ç«¯æ”¯æŒ
- [ ] æ’ä»¶ç³»ç»Ÿ

---

**Chips Battle Remake** - é‡æ–°å®šä¹‰å‘½ä»¤è¡Œæ¸¸æˆä½“éªŒ ğŸ®