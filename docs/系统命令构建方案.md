# 🎮 游戏控制台系统级命令构建方案

## 🎯 设计目标

为游戏内控制台设计实用的系统级命令，专注于游戏体验、调试功能和基础控制，提供简洁易用的命令接口。

## 📋 命令分类与规划

### 🎮 游戏控制命令 (GameControlCommands)

```bash
# 游戏退出 (多别名支持)
quit / exit / stop / shutdown    - 退出游戏

# 游戏信息查看
version / ver / v                - 游戏版本信息
status / stat / info             - 游戏状态概览（完善status界面）
uptime / runtime                 - 游戏运行时间
```

### 🕒 时间系统命令 (增强现有命令)

```bash
# 基础时间控制
time / jctime       - 时间控制主命令
time status / time info / time stat - 时间状态查看
time speed <倍率> / time scale / time rate - 时间倍率设置
time pause / time stop / time freeze - 暂停时间
time resume / time start / time play - 恢复时间
```

### 📊 日志系统命令 (LogCommands)

```bash
# 日志查看
log / logs                       - 显示最新日志
log show [行数] / log tail       - 显示指定行数日志
log error / log err              - 显示错误日志
log warn / log warning           - 显示警告日志
log info                         - 显示信息日志
log debug / log dbg              - 显示调试日志

# 日志管理
log clear / log clean / log cls  - 清空日志
log save <文件名> / log export   - 导出日志到文件
log level <级别> / log setlevel  - 设置日志级别
log filter <关键词> / log grep   - 过滤日志内容
log search <关键词> / log find   - 搜索日志

# 日志配置
log config / log settings        - 日志配置信息
log rotate / log roll            - 日志轮转
log size                         - 日志文件大小
```

### 🐛 调试命令 (DebugCommands)

#### 调试模式控制
```bash
debug / dbg                      - 显示调试状态
debug on / debug enable / debug start - 开启调试模式
debug off / debug disable / debug stop - 关闭调试模式
debug status / debug info        - 调试状态详细信息
```

#### 调试工具的具体应用

**1. 内存调试**
```bash
debug memory / debug mem         - 显示内存使用情况
# 输出示例：
# 总内存: 512MB
# 已使用: 256MB (50%)
# 可用: 256MB
# 游戏对象数量: 1024
# 数据库连接池: 5/10
```

**2. 变量状态查看**
```bash
debug vars / debug variables     - 显示关键游戏变量
# 输出示例：
# 当前用户: alice
# 游戏时间: 2024-01-15 14:30:00
# 时间倍率: 2.0x
# 活跃服务: TimeService, BankService, NewsService
# 数据库状态: 连接正常
```

**3. 调用栈追踪**
```bash
debug trace / debug stack        - 显示当前调用栈
# 用于调试命令执行流程和错误定位
# 输出最近10个函数调用的堆栈信息
```

**4. 调试信息导出**
```bash
debug dump / debug export        - 导出完整调试信息
# 生成包含以下内容的调试报告：
# - 系统状态快照
# - 错误日志摘要
# - 内存使用详情
# - 服务运行状态
# - 数据库连接信息
```

**5. 垃圾回收信息**
```bash
debug gc / debug garbage         - 显示垃圾回收统计
# 输出示例：
# GC运行次数: 15
# 上次GC时间: 2分钟前
# 回收对象数: 1024
# GC耗时: 5ms
```

### 🎨 界面控制命令 (UICommands)

#### 重点实现：清屏命令
```bash
# 控制台清屏 (多别名支持)
cls / clear / clean / clr        - 清屏命令
# 功能：
# - 清除控制台所有输出内容
# - 重置光标位置到顶部
# - 保持命令历史记录
# - 支持Rich格式的美化清屏效果
```

#### 其他界面控制
```bash
echo <文本> / print / say        - 输出文本
color <颜色> / colour            - 设置控制台颜色
font <大小> / fontsize           - 设置字体大小
```

## 🏗️ 技术实现架构

### 1. 命令别名系统

```python
# 在 commands/base.py 中扩展
class Command(ABC):
    @property
    def aliases(self) -> List[str]:
        """命令别名列表"""
        return []
    
    @property
    def all_names(self) -> List[str]:
        """获取命令的所有名称（包括别名）"""
        return [self.name] + self.aliases
```

### 2. 目录结构规划

```
commands/
├── system/              # 新建系统命令目录
│   ├── __init__.py
│   ├── game_control.py  # 游戏控制命令
│   ├── log.py          # 日志系统命令
│   ├── debug.py        # 调试命令
│   └── ui.py           # 界面控制命令 (重点实现cls)
├── time_commands.py     # 增强现有时间命令别名
└── basic/              # 现有基础命令
    ├── quit.py         # 增强quit命令别名
    └── ...
```

### 3. 清屏命令实现示例

```python
# commands/system/ui.py
from commands.base import Command, CommandResult, CommandContext
from rich.console import Console
from typing import List

class UICommand(Command):
    """界面控制命令"""
    
    def __init__(self):
        super().__init__()
        self.console = Console()
    
    @property
    def name(self) -> str:
        return "cls"
    
    @property
    def aliases(self) -> List[str]:
        return ["clear", "clean", "clr"]
    
    @property
    def description(self) -> str:
        return "清屏命令 - 清除控制台内容"
    
    @property
    def category(self) -> str:
        return "ui"
    
    async def execute(self, args: List[str], context: CommandContext) -> CommandResult:
        """执行清屏命令"""
        try:
            # 清除控制台内容
            self.console.clear()
            
            # 可选：显示清屏完成提示
            if args and args[0] == "--verbose":
                return CommandResult(
                    success=True,
                    message="✨ 控制台已清屏"
                )
            
            return CommandResult(success=True, message="")
            
        except Exception as e:
            return CommandResult(
                success=False,
                message=f"清屏失败: {str(e)}"
            )
```

## 🚀 实现优先级

### 第一阶段：基础功能
1. **清屏命令 (cls)** - 立即实现，提升用户体验
2. **游戏控制增强** - 为现有quit命令添加更多别名
3. **时间系统别名** - 增强现有时间命令的易用性

### 第二阶段：调试工具
4. **日志系统命令** - 核心调试功能
5. **调试工具** - debug系列命令，重点是内存和变量查看

### 第三阶段：界面美化
6. **界面控制扩展** - color、font等美化命令
7. **输出格式优化** - Rich格式支持

## 🎯 核心特性

- **多别名支持**: 每个命令支持3-5个常用别名，适应不同用户习惯
- **调试友好**: 提供丰富的调试信息查看和导出功能
- **界面美化**: 支持Rich格式输出和控制台美化
- **简洁实用**: 专注于游戏开发和调试的核心需求
- **渐进实现**: 按优先级分阶段实现，确保核心功能优先可用

## 📝 实现注意事项

1. **命令注册**: 利用现有的CommandRegistry自动发现机制
2. **错误处理**: 所有命令都要有完善的异常处理
3. **帮助信息**: 每个命令都要提供清晰的使用说明
4. **性能考虑**: 调试命令不应影响游戏正常运行性能
5. **用户体验**: 命令响应要快速，输出要清晰易读

这个方案专注于游戏控制台的实际需求，提供了完整的调试工具链和基础控制功能，特别强调了debug命令的具体应用场景和cls命令的优先实现。